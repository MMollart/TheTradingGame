<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Game - Dashboard</title>
    <link rel="stylesheet" href="dashboard-styles.css?v=26">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-left">
                <h1>üéÆ Trading Game</h1>
                <div class="game-code-display">
                    Game Code: <span id="header-game-code">------</span>
                </div>
            </div>
            <div class="header-center">
                <div class="countdown-timer" id="countdown-timer" style="display: none;">
                    <span style="font-size: 14px; color: #ccc; margin-right: 10px;">‚è±Ô∏è Time Remaining:</span>
                    <span id="countdown-display" style="font-size: 28px; font-weight: bold; color: #fff; font-family: 'Courier New', monospace;">00:00</span>
                </div>
                <div class="test-mode-toggle" id="test-mode-toggle-container" style="display: none;">
                    <label class="toggle-switch">
                        <input type="checkbox" id="test-mode-toggle" onchange="toggleTestMode(this.checked)">
                        <span class="toggle-slider"></span>
                    </label>
                    <span class="toggle-label">üß™ Test Mode</span>
                </div>
                <div class="role-view-switcher" id="role-view-switcher" style="display: none;">
                    <label for="view-as-role" style="font-weight: 600; font-size: 14px; color: white; margin-right: 10px;">üëÅÔ∏è View As:</label>
                    <select id="view-as-role" onchange="switchRoleView(this.value)" class="role-selector">
                        <option value="host">Host</option>
                        <option value="banker">Banker</option>
                        <option value="player">Player</option>
                    </select>
                </div>
                <div class="player-view-switcher" id="player-view-switcher" style="display: none;">
                    <label for="view-as-player" style="font-weight: 600; font-size: 14px; color: white; margin-right: 10px;">üë§ View Player:</label>
                    <select id="view-as-player" onchange="switchPlayerView(this.value)" class="player-selector">
                        <option value="">Select Player...</option>
                    </select>
                </div>
            </div>
            <div class="header-right">
                <a href="help.html" target="_blank" style="color: white; text-decoration: none; margin-right: 20px; font-size: 1.1em; font-weight: 600;" title="How to Play">
                    ‚ùì Help
                </a>
                <span id="player-name-display"></span>
                <span id="connection-status" class="status-indicator">‚óè</span>
            </div>
        </header>

        <!-- Main Content -->
        <div class="dashboard-main">
            <!-- Host Dashboard -->
            <div id="host-dashboard" class="role-dashboard hidden">
                <h2>üéÆ Game Host Dashboard</h2>
                
                <!-- Dashboard Tabs -->
                <div class="dashboard-tabs" id="dashboard-tabs-container">
                    <button class="tab-btn active" id="tab-btn-controls" onclick="switchHostTab('controls')">üéÆ Game Controls</button>
                    <button class="tab-btn" id="tab-btn-nations" onclick="switchHostTab('nations')">üåç Nations Overview</button>
                    <button class="tab-btn" id="tab-btn-resources" onclick="switchHostTab('resources')">üì¶ Team Resources</button>
                    <button class="tab-btn" id="tab-btn-challenges" onclick="switchHostTab('challenges')">‚è±Ô∏è Active Challenges</button>
                    <button class="tab-btn" id="tab-btn-banker" onclick="switchHostTab('banker')">üè¶ Banker View</button>
                </div>
                
                <!-- Welcome Banner with Game Code -->
                <div id="welcome-banner" class="welcome-banner">
                    <div class="welcome-content">
                        <h3>üéâ Game Created Successfully!</h3>
                        <p>Share this code with players to join:</p>
                        <div class="big-game-code" id="big-game-code">------</div>
                        <button class="btn btn-secondary" onclick="copyGameCode()">üìã Copy Code</button>
                        <button class="btn btn-primary" onclick="dismissWelcome()">‚úì Got It</button>
                    </div>
                </div>
                
                <!-- Game Controls Tab -->
                <div id="host-tab-controls" class="host-tab-content active">
                <div class="dashboard-grid">
                    <!-- Game Controls -->
                    <div class="card" id="card-game-controls">
                        <h3>Game Controls</h3>
                        <div class="button-group">
                            <button id="start-game-btn" class="btn btn-primary">‚ñ∂Ô∏è Start Game</button>
                            <button id="pause-game-btn" class="btn btn-warning" disabled>‚è∏Ô∏è Pause Game</button>
                            <button id="resume-game-btn" class="btn btn-success" disabled>‚ñ∂Ô∏è Resume</button>
                            <button id="end-game-btn" class="btn btn-danger" disabled>üèÅ End Game</button>
                            <button class="btn btn-secondary" onclick="openGameSettings()">‚öôÔ∏è Settings</button>
                            <button class="btn btn-warning" onclick="clearAllPlayers()">üë• Remove All Players</button>
                            <button class="btn btn-warning" onclick="resetAllChallenges()" title="Clear all pending and active challenges">üîÑ Reset All Challenges</button>
                            <button class="btn btn-danger" onclick="deleteGame()">üóëÔ∏è Delete Game</button>
                        </div>
                        <div class="game-status">
                            Status: <span id="game-status-display">Waiting</span>
                        </div>
                    </div>

                    <!-- Players Overview -->
                    <div class="card" id="card-connected-players">
                        <h3>Connected Players</h3>
                        <div id="players-list" class="players-list">
                            <!-- Players will be added here -->
                        </div>
                    </div>

                    <!-- Pending Approvals (Host Only) -->
                    <div class="card" id="card-pending-approvals">
                        <h3>Pending Approvals</h3>
                        <div class="pending-approval-section">
                            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                                Guest users need approval before they can join. Authenticated users join automatically.
                            </p>
                            <div class="pending-count" style="margin-bottom: 15px;">
                                <strong>Waiting for approval: <span id="pending-count" style="color: #ff9800;">0</span></strong>
                            </div>
                            <div id="pending-players-list" class="pending-list">
                                <!-- Pending players will be listed here -->
                            </div>
                        </div>
                    </div>

                    <!-- Team Assignment (Host Only) -->
                    <div class="card full-width" id="card-team-assignment">
                        <h3>Team Assignment</h3>
                        <div class="team-assignment-section">
                            <div class="assignment-controls">
                                <button id="auto-assign-btn" class="btn btn-success" onclick="autoAssignTeams()">üé≤ Auto-Assign All Players</button>
                                <button class="btn btn-secondary" onclick="refreshUnassigned()">üîÑ Refresh</button>
                            </div>
                            
                            <div class="drag-drop-info" style="padding: 10px; background: #e3f2fd; border-radius: 6px; margin: 15px 0;">
                                <p style="font-size: 14px; margin: 0;">
                                    üí° <strong>Drag & Drop:</strong> Drag players from the list below or between teams to reassign them.
                                </p>
                            </div>
                            
                            <!-- Hidden input for fake players (used by modal) -->
                            <input type="hidden" id="num-fake-players" value="8">
                            
                            <!-- Team Boxes -->
                            <div class="teams-grid" id="teams-grid">
                                <!-- Team boxes will be dynamically created here -->
                            </div>

                            <div class="unassigned-section">
                                <h4>Unassigned Players (<span id="unassigned-count">0</span>)</h4>
                                <div id="unassigned-players-list" class="unassigned-list">
                                    <!-- Unassigned players will be listed here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Game Events Log -->
                    <div class="card full-width" id="card-game-events">
                        <h3>Game Events</h3>
                        <div id="events-log" class="events-log">
                            <!-- Events will be added here -->
                        </div>
                    </div>
                </div>
                </div>
                <!-- End Game Controls Tab -->
                
                <!-- Nations Overview Tab -->
                <div id="host-tab-nations" class="host-tab-content">
                    <div class="dashboard-grid">
                        <!-- Nations Overview (shared with banker) -->
                        <div class="card full-width">
                            <h3>üåç All Nations Overview</h3>
                            <div id="host-nations-overview" class="nations-grid">
                                <!-- Nation cards will be added here -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Nations Overview Tab -->
                
                <!-- Team Resources Tab -->
                <div id="host-tab-resources" class="host-tab-content">
                    <div class="dashboard-grid">
                        <div class="card full-width">
                            <h3>üì¶ Team Resources & Buildings</h3>
                            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                                Quick overview of each team's current resources and buildings
                            </p>
                            <div id="team-resources-overview" class="teams-resources-grid">
                                <!-- Team resource cards will be added here -->
                            </div>
                        </div>
                        
                        <!-- Manual Resource/Building Management (Host Only) -->
                        <div class="card full-width" id="manual-management-card" style="display: none;">
                            <h3>üéõÔ∏è Manual Resource & Building Management</h3>
                            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                                Manually add or remove resources and buildings for any team
                            </p>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <!-- Give Resources -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                    <h4 style="margin-top: 0;">üí∞ Give Resources</h4>
                                    <div class="manual-control-form">
                                        <label>Team:</label>
                                        <select id="give-resources-team" class="form-select">
                                            <option value="">Select Team...</option>
                                            <option value="1">Team 1</option>
                                            <option value="2">Team 2</option>
                                            <option value="3">Team 3</option>
                                            <option value="4">Team 4</option>
                                        </select>
                                        
                                        <label>Resource Type:</label>
                                        <select id="give-resources-type" class="form-select">
                                            <option value="currency">üí∞ Currency</option>
                                            <option value="food">üåæ Food</option>
                                            <option value="raw_materials">‚öôÔ∏è Raw Materials</option>
                                            <option value="electrical_goods">‚ö° Electrical Goods</option>
                                            <option value="medical_goods">üè• Medical Goods</option>
                                        </select>
                                        
                                        <label>Amount:</label>
                                        <input type="number" id="give-resources-amount" class="form-input" min="1" value="10" placeholder="Amount">
                                        
                                        <button onclick="giveResources()" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
                                            ‚ûï Give Resources
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Give Buildings -->
                                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                                    <h4 style="margin-top: 0;">üèóÔ∏è Give Buildings</h4>
                                    <div class="manual-control-form">
                                        <label>Team:</label>
                                        <select id="give-buildings-team" class="form-select">
                                            <option value="">Select Team...</option>
                                            <option value="1">Team 1</option>
                                            <option value="2">Team 2</option>
                                            <option value="3">Team 3</option>
                                            <option value="4">Team 4</option>
                                        </select>
                                        
                                        <label>Building Type:</label>
                                        <select id="give-buildings-type" class="form-select">
                                            <option value="farm">üåæ Farm</option>
                                            <option value="mine">‚õèÔ∏è Mine</option>
                                            <option value="electrical_factory">‚ö° Electrical Factory</option>
                                            <option value="medical_factory">üè• Medical Factory</option>
                                            <option value="school">üè´ School</option>
                                            <option value="hospital">üè• Hospital</option>
                                            <option value="restaurant">üçΩÔ∏è Restaurant</option>
                                            <option value="infrastructure">üèóÔ∏è Infrastructure</option>
                                        </select>
                                        
                                        <label>Quantity:</label>
                                        <input type="number" id="give-buildings-amount" class="form-input" min="1" value="1" placeholder="Quantity">
                                        
                                        <button onclick="giveBuildings()" class="btn btn-primary" style="width: 100%; margin-top: 10px;">
                                            ‚ûï Give Buildings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Team Resources Tab -->
                
                <!-- Active Challenges Tab -->
                <div id="host-tab-challenges" class="host-tab-content">
                    <div class="dashboard-grid">
                        <div class="card full-width">
                            <h3>‚è±Ô∏è Active Challenges</h3>
                            <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                                Monitor active challenges with countdown timers. Challenges expire after 10 minutes.
                            </p>
                            <div id="active-challenges-list" class="active-challenges-list">
                                <p style="color: #999; font-style: italic;">No active challenges</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Active Challenges Tab -->
                
                <!-- Banker View Tab (Host Only) -->
                <div id="host-tab-banker" class="host-tab-content">
                    <div class="dashboard-grid">
                        <!-- Bank Inventory -->
                        <div class="card">
                            <h3>Bank Inventory</h3>
                            <div id="host-bank-inventory" class="resource-list">
                                <!-- Bank resources will be listed here -->
                            </div>
                        </div>

                        <!-- Resource Prices -->
                        <div class="card">
                            <h3>Resource Prices</h3>
                            <div id="host-bank-prices" class="price-controls">
                                <div class="price-item">
                                    <label>Food</label>
                                    <input type="number" id="host-price-food" min="1" value="2">
                                    <button onclick="updatePrice('food', 'host')">Update</button>
                                </div>
                                <div class="price-item">
                                    <label>Raw Materials</label>
                                    <input type="number" id="host-price-raw-materials" min="1" value="3">
                                    <button onclick="updatePrice('raw_materials', 'host')">Update</button>
                                </div>
                                <div class="price-item">
                                    <label>Electrical Goods</label>
                                    <input type="number" id="host-price-electrical-goods" min="1" value="15">
                                    <button onclick="updatePrice('electrical_goods', 'host')">Update</button>
                                </div>
                                <div class="price-item">
                                    <label>Medical Goods</label>
                                    <input type="number" id="host-price-medical-goods" min="1" value="20">
                                    <button onclick="updatePrice('medical_goods', 'host')">Update</button>
                                </div>
                            </div>
                        </div>

                        <!-- Challenge Requests -->
                        <div class="card full-width" id="card-challenge-requests">
                            <h3>üèãÔ∏è Production Challenge Requests</h3>
                            <div class="challenge-requests-section">
                                <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                                    Players will request challenges before they can produce resources. Assign appropriate physical challenges.
                                </p>
                                <div id="challenge-requests-list" class="challenge-requests-list">
                                    <p style="color: #999; font-style: italic;">No pending challenge requests</p>
                                </div>
                            </div>
                        </div>

                        <!-- Events & Disasters -->
                        <div class="card full-width">
                            <h3>Trigger Events</h3>
                            <div class="event-controls">
                                <div class="event-section">
                                    <h4>Food Tax</h4>
                                    <button class="btn btn-primary" onclick="triggerFoodTax()">üí∞ Apply Food Tax (All Nations)</button>
                                </div>
                                
                                <div class="event-section">
                                    <h4>Natural Disasters</h4>
                                    <select id="host-disaster-nation">
                                        <option value="all">All Nations</option>
                                        <option value="1">Nation 1</option>
                                        <option value="2">Nation 2</option>
                                        <option value="3">Nation 3</option>
                                        <option value="4">Nation 4</option>
                                    </select>
                                    <select id="host-disaster-type">
                                        <option value="natural_disaster">Natural Disaster</option>
                                        <option value="drought">Drought</option>
                                        <option value="disease">Disease</option>
                                        <option value="famine">Famine</option>
                                        <option value="climate_change">Climate Change</option>
                                    </select>
                                    <input type="number" id="host-disaster-severity" min="1" max="5" value="1" placeholder="Severity (1-5)">
                                    <button class="btn btn-danger" onclick="triggerDisaster('host')">‚ö†Ô∏è Trigger</button>
                                </div>

                                <div class="event-section">
                                    <h4>Trade with Nations</h4>
                                    <select id="host-trade-nation">
                                        <option value="">Select Nation</option>
                                        <option value="1">Nation 1</option>
                                        <option value="2">Nation 2</option>
                                        <option value="3">Nation 3</option>
                                        <option value="4">Nation 4</option>
                                    </select>
                                    <button class="btn btn-success" onclick="openBankTrade('host')">üí± Open Trade Window</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Banker View Tab -->
            </div>

            <!-- Nation/Player Dashboard -->
            <div id="nation-dashboard" class="role-dashboard hidden">
                <h2 id="player-title">Player Dashboard</h2>
                
                <div class="dashboard-grid">
                    <!-- Resources -->
                    <div class="card" id="card-resources">
                        <h3>Resources</h3>
                        <div id="nation-resources" class="resource-list">
                            <!-- Resources will be listed here -->
                        </div>
                    </div>

                    <!-- Buildings -->
                    <div class="card" id="card-buildings">
                        <h3>Buildings</h3>
                        <div id="nation-buildings" class="building-list">
                            <!-- Buildings will be listed here -->
                        </div>
                    </div>

                    <!-- Team Members -->
                    <div class="card full-width">
                        <h3>Your Team</h3>
                        <div id="team-info" style="margin-bottom: 12px; font-size: 16px; color: #666;">
                            <!-- Team assignment info will appear here -->
                        </div>
                        <div id="team-name-section" style="margin-bottom: 15px; padding: 12px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #667eea; display: none;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-weight: 600; color: #333;">Team Name:</span>
                                <span id="current-team-name" ondblclick="editPlayerTeamName()" title="Double-click to edit" style="flex: 1; color: #667eea; font-weight: 600; cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: background 0.2s;">Loading...</span>
                                <input type="text" id="team-name-edit-input" style="display: none; flex: 1; padding: 6px 10px; border: 2px solid #667eea; border-radius: 4px; font-size: 14px; font-weight: 600;" />
                                <button class="btn-icon-edit" onclick="editPlayerTeamName()" title="Edit team name" style="background: #667eea; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div id="team-members-list" class="team-members-list">
                            <!-- Team members will be listed here -->
                        </div>
                    </div>

                    <!-- Production -->
                    <div class="card full-width" id="card-production">
                        <h3>Production</h3>
                        <div id="production-controls" class="production-grid">
                            <div class="production-item">
                                <h4>üåæ Farm</h4>
                                <p>Produces: Food</p>
                                <p>Buildings: <span id="farm-count">0</span></p>
                                <p class="challenge-display" id="farm-challenge-display" style="display: none;">Challenge: <span id="farm-challenge">Awaiting challenge...</span></p>
                                <button class="btn btn-primary" onclick="requestChallenge('farm')" id="farm-request-btn">üìã Request Challenge</button>
                                <button class="btn btn-success" onclick="startProduction('farm')" id="farm-produce-btn" style="display: none;">‚úÖ Complete Challenge</button>
                            </div>
                            <div class="production-item">
                                <h4>‚õèÔ∏è Mine</h4>
                                <p>Produces: Raw Materials</p>
                                <p>Buildings: <span id="mine-count">0</span></p>
                                <p class="challenge-display" id="mine-challenge-display" style="display: none;">Challenge: <span id="mine-challenge">Awaiting challenge...</span></p>
                                <button class="btn btn-primary" onclick="requestChallenge('mine')" id="mine-request-btn">üìã Request Challenge</button>
                                <button class="btn btn-success" onclick="startProduction('mine')" id="mine-produce-btn" style="display: none;">‚úÖ Complete Challenge</button>
                            </div>
                            <div class="production-item">
                                <h4>‚ö° Electrical Factory</h4>
                                <p>Produces: Electrical Goods</p>
                                <p>Requires: 5 Raw Materials per building</p>
                                <p>Buildings: <span id="electrical_factory-count">0</span></p>
                                <p class="challenge-display" id="electrical_factory-challenge-display" style="display: none;">Challenge: <span id="electrical_factory-challenge">Awaiting challenge...</span></p>
                                <button class="btn btn-primary" onclick="requestChallenge('electrical_factory')" id="electrical_factory-request-btn">üìã Request Challenge</button>
                                <button class="btn btn-success" onclick="startProduction('electrical_factory')" id="electrical_factory-produce-btn" style="display: none;">‚úÖ Complete Challenge</button>
                            </div>
                            <div class="production-item">
                                <h4>üè• Medical Factory</h4>
                                <p>Produces: Medical Goods</p>
                                <p>Requires: 5 Food per building</p>
                                <p>Buildings: <span id="medical_factory-count">0</span></p>
                                <p class="challenge-display" id="medical_factory-challenge-display" style="display: none;">Challenge: <span id="medical_factory-challenge">Awaiting challenge...</span></p>
                                <button class="btn btn-primary" onclick="requestChallenge('medical_factory')" id="medical_factory-request-btn">üìã Request Challenge</button>
                                <button class="btn btn-success" onclick="startProduction('medical_factory')" id="medical_factory-produce-btn" style="display: none;">‚úÖ Complete Challenge</button>
                            </div>
                        </div>
                    </div>

                    <!-- Trading -->
                    <div class="card full-width" id="card-trading">
                        <h3>Trading</h3>
                        <div class="trading-controls">
                            <button class="btn btn-primary" onclick="openTradeWindow('bank')">üí∞ Trade with Bank</button>
                            <button class="btn btn-primary" onclick="openTradeWindow('nation')">ü§ù Trade with Nation</button>
                        </div>
                    </div>

                    <!-- Build Buildings -->
                    <div class="card full-width" id="card-build-buildings">
                        <h3>Build New Buildings</h3>
                        <div id="build-controls" class="build-grid">
                            <!-- Building options will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Trade Modal -->
    <div id="trade-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close" onclick="closeTradeModal()">&times;</span>
            <h2>Trade Resources</h2>
            <div id="trade-form">
                <!-- Trade form will be populated here -->
            </div>
        </div>
    </div>

    <!-- Production Challenge Modal -->
    <div id="challenge-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Complete Physical Challenge</h2>
            <div id="challenge-content">
                <p id="challenge-description"></p>
                <div class="challenge-buttons">
                    <button class="btn btn-success" onclick="completeChallenge()">‚úÖ Challenge Completed</button>
                    <button class="btn btn-secondary" onclick="closeChallengeModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚öôÔ∏è Game Settings</h2>
                <button class="modal-close" onclick="closeGameSettings()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-section">
                    <h3>Team Configuration</h3>
                    <p class="setting-warning">
                        <strong>‚ö†Ô∏è Important:</strong> Set the number of teams BEFORE players join the game!
                    </p>
                    <div class="setting-control">
                        <label for="num-teams-modal">Number of Teams:</label>
                        <input type="number" id="num-teams-modal" min="1" max="20" value="4">
                        <button class="btn btn-primary" onclick="applyTeamConfiguration()">‚úì Apply</button>
                        <span id="teams-status-modal" class="status-text"></span>
                    </div>
                </div>

                <div class="setting-section">
                    <h3>Game Rules</h3>
                    <div class="setting-control">
                        <label for="game-duration-modal">Game Duration: <span id="duration-display-modal">2 hours</span></label>
                        <input type="range" id="game-duration-modal" min="60" max="240" step="30" value="120" 
                               oninput="updateDurationDisplayModal(this.value)">
                        <small style="color: #666;">How long the game will last (1 to 4 hours)</small>
                    </div>
                    <div class="setting-control">
                        <label for="food-tax-timer">Food Tax Timer (minutes):</label>
                        <input type="number" id="food-tax-timer" min="1" max="60" value="15">
                    </div>
                    <div class="setting-control">
                        <label for="starting-resources">Starting Resources per Team:</label>
                        <input type="number" id="starting-resources" min="0" max="1000" value="100">
                    </div>
                    <div class="setting-control">
                        <label for="allow-team-names">
                            <input type="checkbox" id="allow-team-names" style="width: auto; margin-right: 8px;">
                            Allow teams to choose their own names
                        </label>
                    </div>
                </div>

                <div class="setting-section">
                    <h3>üèãÔ∏è Challenge Activities</h3>
                    <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                        Configure default target numbers for production challenges
                    </p>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                                <th style="padding: 10px; text-align: left; font-weight: 600;">Activity</th>
                                <th style="padding: 10px; text-align: center; font-weight: 600; width: 150px;">Default Target</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Push-ups</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-push_ups" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Sit-ups</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-sit_ups" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Burpees</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-burpees" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Star Jumps</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-star_jumps" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Squats</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-squats" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Lunges</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-lunges" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid #dee2e6;">
                                <td style="padding: 10px;">Plank (seconds)</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-plank" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 10px;">Jumping Jacks</td>
                                <td style="padding: 10px; text-align: center;">
                                    <input type="number" id="challenge-jumping_jacks" min="1" max="999" value="20" 
                                           style="width: 80px; padding: 5px; border: 2px solid #ddd; border-radius: 4px; text-align: center;">
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div style="margin-top: 15px; text-align: right;">
                        <button class="btn btn-primary" onclick="applyChallengeDefaults()" style="padding: 8px 20px; font-size: 14px;">
                            ‚úì Apply Challenge Defaults
                        </button>
                    </div>
                </div>

                <div class="setting-section test-mode-section" id="test-mode-settings" style="display: none;">
                    <h3>üß™ Test Mode</h3>
                    <div class="setting-control">
                        <label for="num-fake-players-modal">Number of Fake Players:</label>
                        <input type="number" id="num-fake-players-modal" min="1" max="50" value="8">
                        <button class="btn btn-success" onclick="createFakePlayersFromModal()">‚ûï Add Fake Players</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeGameSettings()">Close</button>
            </div>
        </div>
    </div>

    <script src="game-api.js?v=38"></script>
    <script src="challenge-manager.js?v=10"></script>
    <script src="dashboard.js?v=58"></script>
</body>
</html>
